# need this if its not in apache.conf
#NameVirtualHost *

Alias /perl/  /var/www/pp/lib/

#<VirtualHost *:80>

#  ServerName www.planetphysics2.org
#  ServerAlias planetphysics2.org
  #DocumentRoot /var/www/pp/

  #RewriteEngine on

  # redirect anything to just planetmath.org url
  #
  #RewriteRule ^/(.*)$ http://planetphysics2.org/$1 [R]
#  Redirect permanent "/" "http://planetphysics2.org/"
#</VirtualHost>

#<VirtualHost *>
#
#  ServerName www.physicslibrary.org
#  DocumentRoot /var/www/pp/
#  
#  RewriteEngine on
  
  # redirect anything to just planetmath.org url
  #
#  RewriteRule ^/(.*)$ http://physicslibrary.org/$1 [R]
#</VirtualHost>

<VirtualHost *:80>
  ServerName images.physicslibrary.org
#  ServerAlias physicslibrary.org
  DocumentRoot /var/www/pp/data

  

#  RewriteEngine on

  # redirect anything to just planetmath.org url
  #
#  RewriteRule ^/(.*)$ http://physicslibrary.org/$1 [R]
#  Redirect permanent "/" "http://physicslibrary.org/"
#</VirtualHost>

# <VirtualHost images.physicslibrary.org:80>
##  ServerName images.physicslibrary.org
  #ServerAlias aux.planetphysics2.org oai.planetphsyics2.org
##  AddType image/x-icon .ico
##  Alias /icons/ /var/www/pp/data/images/
##  ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
##  DocumentRoot /var/www/pp/data
  #Ben Added
##  Options Indexes Includes FollowSymLinks MultiViews

<Directory /var/www/pp/data/>
    Options Indexes Includes FollowSymLinks MultiViews
    AllowOverride All
    #Order allow,deny
    Require all granted
  </Directory>

  <Directory /var/www/pp/data/cache/>
    Options Indexes Includes FollowSymLinks ExecCGI
    AllowOverride All
    #Order allow,deny
    Require all granted
  </Directory>

##<Directory /var/www/pp/data/>
    #Ben added Includes FollowSymLinks
##    Options Indexes Includes FollowSymLinks MultiViews
##    AllowOverride None
    #Order allow,deny
##   Require all granted
##</Directory>

  
  
##  <Directory /var/www/pp/data/oai/>
    #Ben added Indexes Includes FollowSymlinks MultiViews
##    Options ExecCGI Indexes Includes FollowSymLinks MultiViews
##    AllowOverride None
    #Order allow,deny
##    Require all granted
##  </Directory>
  
  ##LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %T %v" full
  ##LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %P %T" debug
  ##LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
  ##LogFormat "%h %l %u %t \"%r\" %>s %b" common
  ##LogFormat "%{Referer}i -> %U" referer
  ##LogFormat "%{User-agent}i" agent
				  
  ##ErrorLog /var/www/pc/log/apache/error.log.2
  ##CustomLog /var/www/pc/log/apache/access.log.2 combined

  <IfModule mod_userdir.c>
      UserDir public_html
  </IfModule>

</VirtualHost> 

<VirtualHost *:80>
  ServerName physicslibrary.org
  #ServerName planetphsyics2.org
  #ServerAlias planetphysics2.org
  DocumentRoot /var/www/pp

  RewriteEngine on

  # user dirs are on main server
  
  RewriteRule ^/www\.(.*)$ http://physicslibrary/$1 [R]
  RewriteRule ^/~(.*)$ http://physicslibrary/~$1 [R]

  #Options Indexes Includes FollowSymLinks
  #AddType image/x-icon .ico
  <Directory /var/www/pp/>
    Options Indexes Includes FollowSymLinks ExecCGI
    AllowOverride None
    #Order allow,deny
    Require all granted
  </Directory>  

  <Directory /var/www/pp/data/>
    Options Indexes Includes FollowSymLinks ExecCGI
    AllowOverride All
    #Order allow,deny
    Require all granted
  </Directory>

  <Directory /var/www/pp/data/cache/>
    Options Indexes Includes FollowSymLinks ExecCGI
    AllowOverride All
    #Order allow,deny
    Require all granted
  </Directory>

  #<Directory /var/www/pp/data/images/>
    #Ben added Includes FollowSymLinks
  #  Options Indexes Includes FollowSymLinks MultiViews
  #  AllowOverride All
    #Order allow,deny
  #  Require all granted
  #</Directory>

  #PerlModule PrintEnv1
  #PerlModule Apache::PrintEnv1
  #PerlModule Apache2::Reload
  #PerlInitHandler Apache2::Reload
  #PerlModule Apache2::compat
  #PerlModule DBI
  ##PerlModule Apache2::Reload
  ##PerlInitHandler Apache2::Reload
  ##PerlSetVar ReloadAll off
  ##PerlSetVar ReloadModules "Noosphere::*" 
  
  <Perl >
      use lib qw(/var/www/pp/lib);
  </Perl>

  PerlRequire /var/www/pp/lib/startup.pl

  <Location />  
    AuthType None
    PerlSetVar Noosphere::basedir /var/www/pp
    SetHandler perl-script
    PerlResponseHandler Noosphere
  	PerlOptions +GlobalRequest
    #PerlOptions +ParseHeaders
    #Options +ExecCGI
    #PerlSendHeader On
    #Require all granted
  </Location>

  #<Location />
  #  require all granted
  #</Location>

  LoadModule apreq_module    modules/mod_apreq2.so
  PerlModule Apache::DBI

  ##PerlModule ModPerl::Registry;
  ##PerlModule Apache2::compat
  ##PerlModule DBI
  ## module not installedPerlModule Apache2::Reload
  ##PerlInitHandler Apache2::Reload
  ##PerlSetVar ReloadAll off
  ##PerlSetVar ReloadModules "Noosphere::*" 

  ##<Perl >
  ##    use lib qw(/var/www/pp/lib);
  ##</Perl>
  ##PerlRequire /var/www/pp/lib/startup.pl

  ##<Location /perl/>
  ##    SetHandler perl-script
  ##    PerlHandler ModPerl::Registry
      ##PerlHandler Noosphere
  ##    Options +ExecCGI
  ##    PerlSendHeader On
  ##    Require all granted
  ##</Location>

  LogLevel debug
  #RewriteEngine on
  #RewriteRule ^/(.*)$ http://physicslibrary.org/$1 [R]

</VirtualHost>

 






